<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Black Brand con Rasca y Chatbot</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      background: #121212;
      color: #fff;
      text-align: center;
    }
    header {
      padding: 20px;
      background: #1f1f1f;
      font-size: 24px;
    }
    button {
      padding: 10px 20px;
      border: none;
      border-radius: 5px;
      background: #ff007f;
      color: white;
      font-size: 16px;
      cursor: pointer;
      margin: 10px;
    }
    #rasca-modal {
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background: rgba(0,0,0,0.8);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 9999;
      flex-direction: column;
    }
    #rasca-canvas {
      border: 2px solid #fff;
      margin-bottom: 15px;
      touch-action: none;
    }
    #rasca-message {
      font-size: 18px;
      color: #0f0;
      margin-bottom: 15px;
    }
    #chatbot {
      position: fixed;
      bottom: 80px;
      right: 20px;
      width: 300px;
      height: 400px;
      background: #fff;
      border-radius: 10px;
      overflow: hidden;
      display: none;
      flex-direction: column;
      box-shadow: 0 0 10px rgba(0,0,0,0.5);
      z-index: 9999;
    }
    #chatbot iframe {
      width: 100%;
      height: 100%;
      border: none;
    }
    .boton-flotante {
      position: fixed;
      bottom: 20px;
      right: 20px;
      background: #25D366;
      color: white;
      border-radius: 50%;
      width: 60px;
      height: 60px;
      font-size: 30px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      box-shadow: 0 4px 6px rgba(0,0,0,0.3);
      z-index: 9999;
    }
    .whatsapp {
      background: #25D366;
      position: fixed;
      bottom: 20px;
      left: 20px;
      border-radius: 50%;
      width: 60px;
      height: 60px;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-size: 30px;
      text-decoration: none;
      box-shadow: 0 4px 6px rgba(0,0,0,0.3);
      z-index: 9999;
    }
  </style>
</head>
<body>

  <header>Bienvenido a Black Brand</header>

  <button id="rasca-btn">üéÅ Rasca y Gana</button>

  <div id="rasca-modal">
    <canvas id="rasca-canvas" width="300" height="150"></canvas>
    <div id="rasca-message"></div>
    <button id="close-rasca">Cerrar</button>
  </div>

  <!-- Chatbot -->
  <div id="chatbot">
    <iframe src="https://example.com/tu-chatbot" title="Chatbot"></iframe>
  </div>

  <!-- Bot√≥n para abrir chatbot -->
  <div class="boton-flotante" id="chatbot-toggle">üí¨</div>

  <!-- Bot√≥n WhatsApp -->
  <a href="https://wa.me/549XXXXXXXXXX" class="whatsapp" target="_blank">üìû</a>

  <script>
    // Rasca y Gana
    const rascaModal = document.getElementById('rasca-modal');
    const rascaCanvas = document.getElementById('rasca-canvas');
    const ctx = rascaCanvas.getContext('2d');
    const rascaMessage = document.getElementById('rasca-message');
    const closeRascaBtn = document.getElementById('close-rasca');
    const openRascaBtn = document.getElementById('rasca-btn');

    let isDrawing = false;
    let lastPoint = null;

    function distanceBetween(p1, p2) {
      return Math.hypot(p2.x - p1.x, p2.y - p1.y);
    }

    function getMousePos(canvas, evt) {
      const rect = canvas.getBoundingClientRect();
      return {
        x: (evt.clientX || evt.touches?.[0]?.clientX) - rect.left,
        y: (evt.clientY || evt.touches?.[0]?.clientY) - rect.top
      };
    }

    function initCanvas() {
      ctx.fillStyle = '#888';
      ctx.fillRect(0, 0, rascaCanvas.width, rascaCanvas.height);
      ctx.font = '24px Arial';
      ctx.fillStyle = '#121212';
      ctx.textAlign = 'center';
      ctx.fillText('¬°Ganaste 10% OFF!', rascaCanvas.width / 2, rascaCanvas.height / 2 + 10);
    }

    function scratch(x, y) {
      ctx.globalCompositeOperation = 'destination-out';
      ctx.beginPath();
      ctx.arc(x, y, 15, 0, Math.PI * 2, false);
      ctx.fill();
      ctx.closePath();
      ctx.globalCompositeOperation = 'source-over';
    }

    function getScratchedPercent() {
      const imageData = ctx.getImageData(0, 0, rascaCanvas.width, rascaCanvas.height);
      let total = imageData.data.length / 4;
      let count = 0;
      for (let i = 3; i < imageData.data.length; i += 4) {
        if (imageData.data[i] === 0) count++;
      }
      return (count / total) * 100;
    }

    function onPointerDown(evt) {
      isDrawing = true;
      lastPoint = getMousePos(rascaCanvas, evt);
      scratch(lastPoint.x, lastPoint.y);
    }

    function onPointerMove(evt) {
      if (!isDrawing) return;
      evt.preventDefault();
      const currentPoint = getMousePos(rascaCanvas, evt);
      const dist = distanceBetween(lastPoint, currentPoint);
      const angle = Math.atan2(currentPoint.y - lastPoint.y, currentPoint.x - lastPoint.x);

      for (let i = 0; i < dist; i += 5) {
        const x = lastPoint.x + Math.cos(angle) * i;
        const y = lastPoint.y + Math.sin(angle) * i;
        scratch(x, y);
      }

      lastPoint = currentPoint;

      if (getScratchedPercent() > 40) {
        rascaMessage.textContent = '¬°Felicidades! Tu descuento est√° activo. üéâ';
        rascaCanvas.removeEventListener('pointerdown', onPointerDown);
        rascaCanvas.removeEventListener('pointermove', onPointerMove);
        rascaCanvas.removeEventListener('pointerup', onPointerUp);
      }
    }

    function onPointerUp() {
      isDrawing = false;
    }

    openRascaBtn.addEventListener('click', () => {
      rascaModal.style.display = 'flex';
      rascaMessage.textContent = '';
      initCanvas();
      rascaCanvas.addEventListener('pointerdown', onPointerDown);
      rascaCanvas.addEventListener('pointermove', onPointerMove);
      rascaCanvas.addEventListener('pointerup', onPointerUp);
      rascaCanvas.addEventListener('pointerleave', onPointerUp);
    });

    closeRascaBtn.addEventListener('click', () => {
      rascaModal.style.display = 'none';
      rascaCanvas.removeEventListener('pointerdown', onPointerDown);
      rascaCanvas.removeEventListener('pointermove', onPointerMove);
      rascaCanvas.removeEventListener('pointerup', onPointerUp);
      rascaCanvas.removeEventListener('pointerleave', onPointerUp);
    });

    // Chatbot Toggle
    const chatbotToggle = document.getElementById('chatbot-toggle');
    const chatbot = document.getElementById('chatbot');

    chatbotToggle.addEventListener('click', () => {
      chatbot.style.display = chatbot.style.display === 'flex' ? 'none' : 'flex';
    });
  </script>

</body>
</html>

    </script>

</body>
</html>
